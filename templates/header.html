{{ define "header" }}
<!DOCTYPE html>
<html lang="en" data-theme="business">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seedance Manager</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Material Symbols Icons -->
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        rel="stylesheet">
    <!-- Tailwind CSS + DaisyUI -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Override DaisyUI defaults for compact design */
        .card {
            border-radius: 0.375rem;
        }

        .btn {
            border-radius: 0.375rem;
        }

        .input,
        .select,
        .textarea {
            border-radius: 0.375rem;
        }

        .modal-box {
            border-radius: 0.375rem;
        }

        .badge {
            border-radius: 0.25rem;
        }
    </style>
    <script>
        const i18n_data = {
            "en": {
                "app.title": "Seedance Manager",
                "nav.settings": "Settings",
                "settings.title": "Settings",
                "settings.language": "Language",
                "settings.apikey": "API Key",
                "settings.apikey.placeholder": "Enter new API Key",
                "settings.apikey.hint": "Updating this will restart the client connection. The key is transient.",
                "btn.cancel": "Cancel",
                "btn.save": "Save",
                "btn.delete": "Delete",
                "btn.download": "Download",
                "footer.text": "&copy; 2026 Seedance Client",

                "projects.title": "Projects",
                "projects.subtitle": "Manage your video generation campaigns",
                "projects.create.placeholder": "New Project Name",
                "projects.create.btn": "Create",
                "projects.open": "Open",

                "sb.back": "Back to Projects",
                "sb.scene": "Storyboard",
                "sb.prompt": "Prompt",
                "sb.first_frame": "First Frame",
                "sb.last_frame": "Last Frame",
                "sb.model": "Model",
                "sb.ratio": "Ratio",
                "sb.duration": "Duration",
                "sb.generating": "Generating...",
                "sb.failed": "Generation Failed",
                "sb.start_gen": "Generate Video",
                "sb.new": "Add New Storyboard",
                "sb.desc_placeholder": "Describe your scene in detail...",
                "sb.desc_hint": "Detailed descriptions yield better results.",
                "sb.upload_img": "Upload Image",
                "sb.add_btn": "Add Storyboard",
                "sb.confirm_delete": "Delete this storyboard?",
                "sb.retry": "Retry",
                "sb.edit": "Edit",
                "sb.edit_title": "Edit Storyboard",
                "sb.update_btn": "Update",
                "sb.download_video": "Download Video",
                "sb.download_lastframe": "Download Last Frame",
                "sb.use_as_firstframe": "Use as First Frame",
                "sb.export": "Export Bundle",
                "sb.mode": "Mode",
                "sb.audio": "Audio"
            },
            "zh": {
                "app.title": "Seedance 管理器",
                "nav.settings": "设置",
                "settings.title": "设置",
                "settings.language": "界面语言",
                "settings.apikey": "API Key",
                "settings.apikey.placeholder": "输入新的 API Key",
                "settings.apikey.hint": "更新此项将重置客户端连接。密钥仅保存在内存中。",
                "btn.cancel": "取消",
                "btn.save": "保存",
                "btn.delete": "删除",
                "btn.download": "下载视频",
                "footer.text": "&copy; 2026 Seedance Client (中文)",

                "projects.title": "项目列表",
                "projects.subtitle": "管理您的视频生成任务",
                "projects.create.placeholder": "新项目名称",
                "projects.create.btn": "创建",
                "projects.open": "打开",

                "sb.back": "返回项目列表",
                "sb.scene": "分镜",
                "sb.prompt": "提示词",
                "sb.first_frame": "首帧 (起始)",
                "sb.last_frame": "尾帧 (结束)",
                "sb.model": "模型",
                "sb.ratio": "比例",
                "sb.duration": "时长",
                "sb.generating": "生成中...",
                "sb.failed": "生成失败",
                "sb.start_gen": "开始生成",
                "sb.new": "添加新分镜",
                "sb.desc_placeholder": "详细描述您的分镜内容...",
                "sb.desc_hint": "描述得越详细，效果越好。",
                "sb.upload_img": "上传图片",
                "sb.add_btn": "添加分镜",
                "sb.confirm_delete": "确定删除该分镜吗？",
                "sb.retry": "重试",
                "sb.edit": "编辑",
                "sb.edit_title": "编辑分镜",
                "sb.update_btn": "更新",
                "sb.download_video": "下载视频",
                "sb.download_lastframe": "下载尾帧",
                "sb.use_as_firstframe": "用作首帧",
                "sb.export": "导出素材包",
                "sb.mode": "模式",
                "sb.audio": "音频"
            }
        };

        function getLanguage() {
            let lang = localStorage.getItem("seedance_lang");
            if (!lang) {
                const browserLang = navigator.language || navigator.userLanguage;
                if (browserLang.toLowerCase().startsWith("zh")) {
                    lang = "zh";
                } else {
                    lang = "en";
                }
            }
            return lang;
        }

        function setLanguage(lang) {
            localStorage.setItem("seedance_lang", lang);
            applyLanguage();
            const sel = document.getElementById("lang-selector");
            if (sel) sel.value = lang;
        }

        function applyLanguage() {
            const lang = getLanguage();
            const data = i18n_data[lang] || i18n_data["en"];

            document.querySelectorAll("[data-i18n]").forEach(el => {
                const key = el.getAttribute("data-i18n");
                if (data[key]) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                        el.placeholder = data[key];
                    } else {
                        el.innerHTML = data[key];
                    }
                }
            });
        }

        window.addEventListener('DOMContentLoaded', () => {
            applyLanguage();
            const sel = document.getElementById("lang-selector");
            if (sel) {
                sel.value = getLanguage();
                sel.addEventListener('change', (e) => {
                    setLanguage(e.target.value);
                });
            }
        });
    </script>
</head>

<body class="bg-base-200 min-h-screen text-base-content">
    <!-- Top App Bar (DaisyUI Navbar) -->
    <div class="navbar bg-base-100 border-b border-base-content/10 mb-4 sticky top-0 z-50">
        <div class="navbar-start">
            <a href="/" class="btn btn-ghost btn-sm text-lg gap-2">
                <span class="material-symbols-outlined text-xl">movie_creation</span>
                <span data-i18n="app.title">Seedance Manager</span>
            </a>
        </div>
        <div class="navbar-end">
            <button onclick="document.getElementById('settings-dialog').showModal()" class="btn btn-ghost btn-sm gap-1">
                <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"
                    fill="currentColor">
                    <path
                        d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-1 13.5l103 78-110 190-119-50q-11 8-23 15t-24 12l-16 128H370Zm112-260q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm0-80q-25 0-42.5-17.5T422-480q0-25 17.5-42.5T482-540q25 0 42.5 17.5T542-480q0 25-17.5 42.5T482-420Z" />
                </svg>
                <span data-i18n="nav.settings">Settings</span>
            </button>
        </div>
    </div>

    <!-- Settings Modal (DaisyUI Modal) -->
    <dialog id="settings-dialog" class="modal">
        <div class="modal-box">
            <h3 class="text-lg font-bold mb-4" data-i18n="settings.title">Settings</h3>

            <div class="form-control mb-3">
                <label class="label py-1">
                    <span class="label-text text-sm font-medium" data-i18n="settings.language">Language</span>
                </label>
                <select id="lang-selector" class="select select-bordered select-sm w-full">
                    <option value="en">English (US)</option>
                    <option value="zh">简体中文 (Simplified Chinese)</option>
                </select>
            </div>

            <form action="/settings/apikey" method="POST">
                <div class="form-control mb-3">
                    <label class="label py-1">
                        <span class="label-text text-sm font-medium" data-i18n="settings.apikey">API Key</span>
                    </label>
                    <input type="password" name="api_key" data-i18n="settings.apikey.placeholder"
                        placeholder="Enter new API Key" class="input input-bordered input-sm w-full">
                    <label class="label py-1">
                        <span class="label-text-alt text-xs" data-i18n="settings.apikey.hint">
                            Updating this will restart the client connection. The key is transient.
                        </span>
                    </label>
                </div>
                <div class="modal-action">
                    <button type="button" onclick="document.getElementById('settings-dialog').close()"
                        class="btn btn-ghost btn-sm" data-i18n="btn.cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary btn-sm" data-i18n="btn.save">Save</button>
                </div>
            </form>
        </div>
        <form method="dialog" class="modal-backdrop">
            <button>close</button>
        </form>
    </dialog>

    <div class="container mx-auto px-4 max-w-6xl">
        {{ end }}

        {{ define "footer" }}
    </div>
    <footer
        class="footer footer-center p-6 bg-base-100 border-t border-base-content/10 text-base-content/60 mt-8 text-sm">
        <p data-i18n="footer.text">&copy; 2026 Seedance Client</p>
    </footer>
</body>

</html>
{{ end }}