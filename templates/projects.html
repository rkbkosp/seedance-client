{{ template "header" . }}

<div class="mb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-3">
    <div>
        <h1 class="text-2xl font-bold text-base-content" data-i18n="projects.title">Projects</h1>
        <p class="text-sm text-base-content/60" data-i18n="projects.subtitle">Manage your video generation campaigns</p>
    </div>

    <!-- Create Project Form -->
    <form action="/projects" method="POST" class="join">
        <input type="text" name="name" data-i18n="projects.create.placeholder" placeholder="New Project Name" required
            class="input input-bordered input-sm join-item w-48">
        <button type="submit" class="btn btn-primary btn-sm join-item gap-1">
            <span class="text-lg font-bold">+</span> <span data-i18n="projects.create.btn">Create</span>
        </button>
    </form>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    {{ range .Projects }}
    <div class="card card-compact bg-base-100 border border-base-content/10">
        <div class="card-body">
            <div class="flex justify-between items-start">
                <h2 class="card-title text-base truncate">{{ .Name }}</h2>
                <!-- Delete Button -->
                <form action="/projects/delete/{{ .ID }}" method="POST" onsubmit="return confirm('Are you sure?');">
                    <button type="submit" class="btn btn-ghost btn-circle btn-xs text-error">
                        <svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 -960 960 960" width="16"
                            fill="currentColor">
                            <path
                                d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z" />
                        </svg>
                    </button>
                </form>
            </div>
            <p class="text-xs text-base-content/50">
                ID: {{ .ID }} &bull; {{ .CreatedAt.Format "Jan 02, 15:04" }}
            </p>
            <div class="card-actions justify-end mt-2">
                <a href="/projects/{{ .ID }}" class="btn btn-secondary btn-sm" data-i18n="projects.open">
                    Open
                </a>
            </div>
        </div>
    </div>
    {{ end }}
</div>

<!-- Data Monitoring Stats -->
<div class="mt-8 card card-compact bg-base-100 border border-base-content/10">
    <div class="card-body">
        <h2 class="card-title text-lg mb-4">Data Monitoring</h2>
        <div class="stats stats-vertical lg:stats-horizontal border border-base-content/10 w-full">
            <!-- Total Videos -->
            <div class="stat py-3">
                <div class="stat-title text-xs">Total Videos</div>
                <div class="stat-value text-xl text-primary">{{ .Stats.TotalVideos }}</div>
                <div class="stat-desc text-xs">
                    1.5 Pro: {{ .Stats.TotalVideos15Pro }} | 1.0 Fast: {{ .Stats.TotalVideos10Fast }}
                </div>
            </div>

            <!-- Token Usage -->
            <div class="stat py-3">
                <div class="stat-title text-xs">Total Tokens</div>
                <div class="stat-value text-xl text-secondary">{{ .Stats.TotalTokenUsage }}</div>
                <div class="stat-desc text-xs">Output Tokens</div>
            </div>

            <!-- Total Cost -->
            <div class="stat py-3">
                <div class="stat-title text-xs">Total Cost</div>
                <div class="stat-value text-xl text-accent">¥{{ printf "%.4f" .Stats.TotalCost }}</div>
                <div class="stat-desc text-xs">Estimated</div>
            </div>

            <!-- Total Savings -->
            <div class="stat py-3">
                <div class="stat-title text-xs">Total Savings</div>
                <div class="stat-value text-xl text-success">¥{{ printf "%.4f" .Stats.TotalSavings }}</div>
                <div class="stat-desc text-xs">vs Platform Price</div>
            </div>
        </div>
    </div>
</div>

{{ template "footer" . }}